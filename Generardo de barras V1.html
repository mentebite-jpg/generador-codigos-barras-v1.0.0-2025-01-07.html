=<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador GS1 Profesional</title>
    <style>
        :root {
            --gs1-orange: #f37021;
            --blue: #253e86;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
            --white: #ffffff;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--blue) 0%, #1a2b5c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: white;
        }
        
        .header p {
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 30px;
            gap: 30px;
        }
        
        .left-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .right-panel {
            flex: 2;
            min-width: 300px;
        }
        
        .panel {
            background: var(--light-gray);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .panel h2 {
            color: var(--blue);
            border-bottom: 2px solid var(--gs1-orange);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        select, input, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--gs1-orange);
            box-shadow: 0 0 0 3px rgba(243, 112, 33, 0.1);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: monospace;
        }
        
        .btn {
            background: var(--gs1-orange);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: #e05c1a;
        }
        
        .btn-secondary {
            background: var(--blue);
        }
        
        .btn-secondary:hover {
            background: #1a2b5c;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .barcode-preview {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
        }
        
        #barcode {
            max-width: 100%;
            height: auto;
        }
        
        .info-box {
            background: #e8f4fd;
            border-left: 4px solid var(--blue);
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: var(--blue);
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            display: none;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .format-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .format-info h4 {
            color: var(--gs1-orange);
            margin-bottom: 8px;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .format-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .format-option:hover {
            border-color: var(--gs1-orange);
            transform: translateY(-2px);
        }
        
        .format-option.active {
            border-color: var(--gs1-orange);
            background: rgba(243, 112, 33, 0.05);
        }
        
        .format-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--blue);
        }
        
        .example {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 24px;
            }
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 14px;
            border-top: 1px solid #eee;
            margin-top: 30px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Generador Profesional de C√≥digos GS1</h1>
            <p>Genere c√≥digos de barras GS1 compatibles con est√°ndares internacionales. ITF-14, GS1-128, EAN-13, UPC y m√°s.</p>
        </div>
        
        <div class="content">
            <div class="left-panel">
                <div class="panel">
                    <h2>Seleccionar Formato</h2>
                    
                    <div class="form-group">
                        <label>Tipo de c√≥digo</label>
                        <select id="formatSelect">
                            <option value="ITF14">ITF-14 (Log√≠stica)</option>
                            <option value="GS1_128">GS1-128 (UCC/EAN-128)</option>
                            <option value="EAN13">EAN-13 (Minorista)</option>
                            <option value="UPCA">UPC-A (Estados Unidos)</option>
                            <option value="CODE128">Code 128</option>
                            <option value="CODE39">Code 39</option>
                        </select>
                    </div>
                    
                    <div id="formatInfo" class="format-info">
                        <h4>ITF-14</h4>
                        <p>14 d√≠gitos num√©ricos. Usado para cajas/log√≠stica. Admite GTIN. No admite atributos.</p>
                    </div>
                </div>
                
                <div class="panel">
                    <h2>Ingresar Datos</h2>
                    
                    <div class="form-group">
                        <label>Datos del c√≥digo</label>
                        <textarea id="dataInput" placeholder="Ejemplo: 12345678901234"></textarea>
                        <div class="example" id="dataExample">Ejemplo: 12345678901234</div>
                    </div>
                    
                    <div id="alertBox" class="alert" style="display: none;"></div>
                    
                    <button class="btn" onclick="generateBarcode()">
                        <span>Generar C√≥digo</span>
                    </button>
                </div>
                
                <div class="panel">
                    <h2>Configuraci√≥n</h2>
                    
                    <div class="settings-grid">
                        <div class="form-group">
                            <label>Ancho (mm)</label>
                            <input type="number" id="widthInput" value="50" min="10" max="200">
                        </div>
                        
                        <div class="form-group">
                            <label>Altura (mm)</label>
                            <input type="number" id="heightInput" value="25" min="10" max="100">
                        </div>
                        
                        <div class="form-group">
                            <label>Mostrar texto</label>
                            <select id="showText">
                                <option value="true">S√≠</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="right-panel">
                <div class="panel">
                    <h2>Vista Previa</h2>
                    
                    <div class="barcode-preview">
                        <svg id="barcode"></svg>
                        <div id="noBarcode" style="display: none;">
                            <p>El c√≥digo de barras aparecer√° aqu√≠ despu√©s de generar.</p>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <h3>Informaci√≥n del C√≥digo</h3>
                        <p id="codeInfo">Seleccione un formato e ingrese datos para generar el c√≥digo.</p>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn" onclick="downloadPNG()">
                            <span>Descargar PNG</span>
                        </button>
                        <button class="btn btn-secondary" onclick="downloadSVG()">
                            <span>Descargar SVG</span>
                        </button>
                        <button class="btn" onclick="printBarcode()">
                            <span>Imprimir</span>
                        </button>
                    </div>
                </div>
                
                <div class="panel">
                    <h2>Formatos Disponibles</h2>
                    
                    <div class="settings-grid">
                        <div class="format-option active" onclick="selectFormat('ITF14')">
                            <div class="format-icon">üì¶</div>
                            <h4>ITF-14</h4>
                            <p>14 d√≠gitos para log√≠stica</p>
                        </div>
                        
                        <div class="format-option" onclick="selectFormat('GS1_128')">
                            <div class="format-icon">üè∑Ô∏è</div>
                            <h4>GS1-128</h4>
                            <p>Hasta 48 caracteres alfanum√©ricos</p>
                        </div>
                        
                        <div class="format-option" onclick="selectFormat('EAN13')">
                            <div class="format-icon">üõí</div>
                            <h4>EAN-13</h4>
                            <p>13 d√≠gitos para minoristas</p>
                        </div>
                        
                        <div class="format-option" onclick="selectFormat('UPCA')">
                            <div class="format-icon">üá∫üá∏</div>
                            <h4>UPC-A</h4>
                            <p>12 d√≠gitos para EE.UU.</p>
                        </div>
                    </div>
                </div>
                
                <div class="panel">
                    <h2>Validaci√≥n GS1</h2>
                    <p>Todos los c√≥digos generados cumplen con los est√°ndares GS1. Se realizan las siguientes validaciones:</p>
                    <ul style="margin: 15px 0 15px 20px;">
                        <li>Longitud correcta seg√∫n formato</li>
                        <li>Caracteres v√°lidos</li>
                        <li>D√≠gitos de control autom√°ticos (EAN/UPC)</li>
                        <li>Formato de identificadores de aplicaci√≥n (GS1-128)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>‚úîÔ∏è Generador compatible con est√°ndares GS1 internacionales</p>
            <p>‚úîÔ∏è No modificar proporciones ni colores del c√≥digo de barras</p>
        </div>
    </div>
    
    <script>
        // Datos de formatos
        const formats = {
            ITF14: {
                name: "ITF-14",
                description: "14 d√≠gitos num√©ricos. Usado para cajas/log√≠stica. Admite GTIN. No admite atributos.",
                example: "12345678901234",
                pattern: /^\d{14}$/,
                error: "ITF-14 requiere exactamente 14 d√≠gitos num√©ricos"
            },
            GS1_128: {
                name: "GS1-128",
                description: "Hasta 48 caracteres alfanum√©ricos. Admite todas las claves GS1. Usar identificadores de aplicaci√≥n entre par√©ntesis.",
                example: "(01)03412345678906(10)ABC123",
                pattern: /^.{1,48}$/,
                error: "GS1-128 admite hasta 48 caracteres alfanum√©ricos"
            },
            EAN13: {
                name: "EAN-13",
                description: "13 d√≠gitos num√©ricos. Usado en comercio minorista internacional.",
                example: "750123456789",
                pattern: /^\d{12,13}$/,
                error: "EAN-13 requiere 12 o 13 d√≠gitos"
            },
            UPCA: {
                name: "UPC-A",
                description: "12 d√≠gitos num√©ricos. Est√°ndar en Estados Unidos para productos minoristas.",
                example: "12345678901",
                pattern: /^\d{11,12}$/,
                error: "UPC-A requiere 11 o 12 d√≠gitos"
            },
            CODE128: {
                name: "Code 128",
                description: "C√≥digo de alta densidad. Admite caracteres ASCII completos.",
                example: "ABC123-456",
                pattern: /^[\x00-\x7F]+$/,
                error: "Code 128 solo admite caracteres ASCII"
            },
            CODE39: {
                name: "Code 39",
                description: "C√≥digo alfanum√©rico simple. Admite letras, n√∫meros y algunos s√≠mbolos.",
                example: "ABC-123",
                pattern: /^[A-Z0-9\-\.\$\+\/%\s]+$/,
                error: "Code 39 solo admite letras may√∫sculas, n√∫meros y -.$/+%"
            }
        };
        
        // Variables globales
        let currentFormat = 'ITF14';
        let currentBarcode = null;
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            updateFormatInfo();
            document.getElementById('formatSelect').value = currentFormat;
            updateFormatOptions();
        });
        
        // Seleccionar formato
        function selectFormat(format) {
            currentFormat = format;
            document.getElementById('formatSelect').value = format;
            updateFormatInfo();
            updateFormatOptions();
            updateExample();
        }
        
        // Actualizar informaci√≥n del formato
        function updateFormatInfo() {
            const format = formats[currentFormat];
            const infoDiv = document.getElementById('formatInfo');
            
            infoDiv.innerHTML = `
                <h4>${format.name}</h4>
                <p>${format.description}</p>
                <p><strong>Ejemplo:</strong> ${format.example}</p>
            `;
            
            document.getElementById('codeInfo').textContent = format.description;
        }
        
        // Actualizar ejemplo
        function updateExample() {
            const format = formats[currentFormat];
            document.getElementById('dataExample').textContent = `Ejemplo: ${format.example}`;
        }
        
        // Actualizar opciones de formato activas
        function updateFormatOptions() {
            document.querySelectorAll('.format-option').forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('onclick').includes(currentFormat)) {
                    option.classList.add('active');
                }
            });
        }
        
        // Mostrar alerta
        function showAlert(message, type = 'error') {
            const alertBox = document.getElementById('alertBox');
            alertBox.textContent = message;
            alertBox.className = `alert alert-${type}`;
            alertBox.style.display = 'block';
            
            // Auto-ocultar alertas de √©xito
            if (type === 'success') {
                setTimeout(() => {
                    alertBox.style.display = 'none';
                }, 5000);
            }
        }
        
        // Ocultar alerta
        function hideAlert() {
            document.getElementById('alertBox').style.display = 'none';
        }
        
        // Calcular d√≠gito de control para EAN/UPC
        function calculateCheckDigit(number) {
            let sum = 0;
            for (let i = 0; i < number.length; i++) {
                const digit = parseInt(number.charAt(i));
                sum += (i % 2 === 0) ? digit * 1 : digit * 3;
            }
            const remainder = sum % 10;
            return remainder === 0 ? 0 : 10 - remainder;
        }
        
        // Validar datos
        function validateData(data, format) {
            hideAlert();
            
            if (!data || data.trim() === '') {
                showAlert('‚ùå Por favor, ingrese datos para generar el c√≥digo', 'error');
                return false;
            }
            
            const formatInfo = formats[format];
            
            if (!formatInfo.pattern.test(data)) {
                showAlert(`‚ùå ${formatInfo.error}`, 'error');
                return false;
            }
            
            // Validaciones espec√≠ficas
            if (format === 'ITF14' && data.length !== 14) {
                showAlert('‚ùå ITF-14 requiere exactamente 14 d√≠gitos', 'error');
                return false;
            }
            
            if (format === 'GS1_128') {
                if (data.length > 48) {
                    showAlert('‚ö†Ô∏è GS1-128 recomienda m√°ximo 48 caracteres. Considere usar m√∫ltiples s√≠mbolos.', 'warning');
                }
                if (data.includes('(') && !data.includes(')')) {
                    showAlert('‚ö†Ô∏è Aseg√∫rese de cerrar los par√©ntesis en los identificadores de aplicaci√≥n', 'warning');
                }
            }
            
            return true;
        }
        
        // Generar c√≥digo de barras
        function generateBarcode() {
            const data = document.getElementById('dataInput').value.trim();
            const format = document.getElementById('formatSelect').value;
            const width = document.getElementById('widthInput').value;
            const height = document.getElementById('heightInput').value;
            const showText = document.getElementById('showText').value === 'true';
            
            // Validar datos
            if (!validateData(data, format)) {
                return;
            }
            
            // Preparar datos seg√∫n formato
            let barcodeData = data;
            let barcodeFormat = format;
            
            // Calcular d√≠gitos de control para EAN/UPC si es necesario
            if ((format === 'EAN13' && data.length === 12) || 
                (format === 'UPCA' && data.length === 11)) {
                const checkDigit = calculateCheckDigit(data);
                barcodeData = data + checkDigit;
            }
            
            // Configurar opciones
            const options = {
                format: barcodeFormat === 'GS1_128' ? 'CODE128' : barcodeFormat,
                width: width / 10, // Convertir mm a unidades
                height: height / 10,
                displayValue: showText,
                fontOptions: 'bold',
                textMargin: 8,
                fontSize: 16,
                background: '#ffffff',
                lineColor: '#000000',
                margin: 15
            };
            
            try {
                // Generar c√≥digo de barras
                JsBarcode("#barcode", barcodeData, options);
                currentBarcode = { data: barcodeData, format: barcodeFormat, options: options };
                
                // Mostrar √©xito
                document.getElementById('noBarcode').style.display = 'none';
                showAlert('‚úÖ C√≥digo generado correctamente', 'success');
                
                // Actualizar informaci√≥n
                document.getElementById('codeInfo').textContent = 
                    `${formats[format].name} generado: ${barcodeData}`;
                    
            } catch (error) {
                showAlert(`‚ùå Error al generar c√≥digo: ${error.message}`, 'error');
            }
        }
        
        // Descargar PNG
        function downloadPNG() {
            if (!currentBarcode) {
                showAlert('‚ùå Genere un c√≥digo de barras primero', 'error');
                return;
            }
            
            const svg = document.getElementById('barcode');
            const serializer = new XMLSerializer();
            const source = serializer.serializeToString(svg);
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            const img = new Image();
            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                
                const pngUrl = canvas.toDataURL('image/png');
                const downloadLink = document.createElement('a');
                downloadLink.href = pngUrl;
                downloadLink.download = `codigo_${formats[currentBarcode.format].name}_${Date.now()}.png`;
                downloadLink.click();
                
                showAlert('‚úÖ Imagen PNG descargada', 'success');
            };
            
            img.src = 'data:image/svg+xml;base64,' + btoa(source);
        }
        
        // Descargar SVG
        function downloadSVG() {
            const svg = document.getElementById('barcode');
            
            if (!svg || !currentBarcode) {
                showAlert('‚ùå Genere un c√≥digo de barras primero', 'error');
                return;
            }
            
            const serializer = new XMLSerializer();
            const source = serializer.serializeToString(svg);
            
            const blob = new Blob([source], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = `codigo_${formats[currentBarcode.format].name}_${Date.now()}.svg`;
            downloadLink.click();
            
            URL.revokeObjectURL(url);
            showAlert('‚úÖ Archivo SVG descargado', 'success');
        }
        
        // Imprimir c√≥digo de barras
        function printBarcode() {
            if (!currentBarcode) {
                showAlert('‚ùå Genere un c√≥digo de barras primero', 'error');
                return;
            }
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Imprimir C√≥digo de Barras</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            text-align: center; 
                            padding: 40px; 
                        }
                        h1 { 
                            color: #253e86; 
                            margin-bottom: 20px; 
                        }
                        svg { 
                            max-width: 100%; 
                            height: auto; 
                            margin: 20px 0; 
                        }
                        .info { 
                            margin-top: 30px; 
                            color: #666; 
                            font-size: 14px; 
                        }
                        @media print {
                            button { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>C√≥digo de Barras ${formats[currentBarcode.format].name}</h1>
                    ${document.getElementById('barcode').outerHTML}
                    <div class="info">
                        <p>${formats[currentBarcode.format].name}</p>
                        <p>Datos: ${currentBarcode.data}</p>
                        <p>Generado: ${new Date().toLocaleString()}</p>
                    </div>
                    <button onclick="window.print()">Imprimir</button>
                    <button onclick="window.close()">Cerrar</button>
                </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        // Cambiar formato desde el select
        document.getElementById('formatSelect').addEventListener('change', function() {
            selectFormat(this.value);
        });
        
        // Actualizar ejemplo cuando cambian los datos
        document.getElementById('dataInput').addEventListener('input', function() {
            updateExample();
        });
    </script>
</body>
</html>